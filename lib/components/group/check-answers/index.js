"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderCheckAnswersGroup=renderCheckAnswersGroup;exports.ObjectAnswer=ObjectAnswer;exports.ArrayAnswer=ArrayAnswer;exports.default=void 0;var _react=_interopRequireDefault(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _immutable=_interopRequireDefault(require("immutable"));var _classnames=_interopRequireDefault(require("classnames"));var _debug=_interopRequireDefault(require("debug"));var _=_interopRequireDefault(require("./.."));var _getCheckAnswersGroupKey=_interopRequireDefault(require("./get-check-answers-group-key"));var _hasElementsTitle=_interopRequireDefault(require("./has-elements-title"));var _getGroup=_interopRequireDefault(require("./get-group"));var _typeStringAnswer=_interopRequireDefault(require("./type-string-answer"));var _typeNumberAnswer=_interopRequireDefault(require("./type-number-answer"));var _typeBooleanAnswer=_interopRequireDefault(require("./type-boolean-answer"));var _typeNullAnswer=_interopRequireDefault(require("./type-null-answer"));var _renderCheckAnswersGroupForObject=_interopRequireDefault(require("./render-check-answers-group-for-object"));var _renderCheckAnswersGroupForArray=_interopRequireDefault(require("./render-check-answers-group-for-array"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}var log=(0,_debug.default)('shinkansen:sprockets:components:group:check-answers');function renderCheckAnswersGroup(){var index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var field=arguments.length>1?arguments[1]:undefined;var resource=arguments.length>2?arguments[2]:undefined;var array=arguments.length>3?arguments[3]:undefined;var group=arguments.length>4?arguments[4]:undefined;log('renderCheckAnswersGroup');var _field$meta=field.meta;_field$meta=_field$meta===void 0?{}:_field$meta;var type=_field$meta.type;switch(type){case'string':return _react.default.createElement(_typeStringAnswer.default,{stringAnswer:field,resource:resource});case'number':return _react.default.createElement(_typeNumberAnswer.default,{key:(0,_getCheckAnswersGroupKey.default)(index),numberAnswer:field,resource:resource});case'object':return _react.default.createElement(ObjectAnswer,{key:(0,_getCheckAnswersGroupKey.default)(index),objectAnswer:field,resource:resource,array:array,group:group});case'array':return _react.default.createElement(ArrayAnswer,{key:(0,_getCheckAnswersGroupKey.default)(index),arrayAnswer:field,resource:resource,array:array,group:group});case'boolean':return _react.default.createElement(_typeBooleanAnswer.default,{key:(0,_getCheckAnswersGroupKey.default)(index),booleanAnswer:field,resource:resource});case'null':return _react.default.createElement(_typeNullAnswer.default,{key:(0,_getCheckAnswersGroupKey.default)(index),nullAnswer:field,resource:resource});}return null;}function ObjectAnswer(_ref){var _ref$objectAnswer$ele=_ref.objectAnswer.elements;_ref$objectAnswer$ele=_ref$objectAnswer$ele===void 0?{}:_ref$objectAnswer$ele;var _ref$objectAnswer$ele2=_ref$objectAnswer$ele.fields,fields=_ref$objectAnswer$ele2===void 0?[]:_ref$objectAnswer$ele2,resource=_ref.resource,array=_ref.array,group=_ref.group;log('ObjectAnswer');return fields.reduce(function(accumulator,field,i,a){if((0,_hasElementsTitle.default)(field)){group=(0,_getGroup.default)(i,a);if(group.length){return accumulator.concat((0,_renderCheckAnswersGroupForObject.default)(i,[field].concat(_toConsumableArray(group)),resource));}}return!group.includes(field)?accumulator.concat(renderCheckAnswersGroup(i,field,resource,array,group)):accumulator;},array);}ObjectAnswer.propTypes={objectAnswer:_propTypes.default.shape({elements:_propTypes.default.shape()}).isRequired,resource:_propTypes.default.shape({alpha:_propTypes.default.string,omega:_propTypes.default.string}).isRequired,array:_propTypes.default.array,group:_propTypes.default.array};ObjectAnswer.defaultProps={objectAnswer:{},resource:{},array:[],group:[]};function ArrayAnswer(_ref2){var _ref2$arrayAnswer$ele=_ref2.arrayAnswer.elements;_ref2$arrayAnswer$ele=_ref2$arrayAnswer$ele===void 0?{}:_ref2$arrayAnswer$ele;var _ref2$arrayAnswer$ele2=_ref2$arrayAnswer$ele.fields,fields=_ref2$arrayAnswer$ele2===void 0?[]:_ref2$arrayAnswer$ele2,resource=_ref2.resource,array=_ref2.array,group=_ref2.group;log('ArrayAnswer');return fields.reduce(function(accumulator,field,i,a){if((0,_hasElementsTitle.default)(field)){group=(0,_getGroup.default)(i,a);if(group.length){return accumulator.concat((0,_renderCheckAnswersGroupForArray.default)(i,[field].concat(_toConsumableArray(group)),resource));}}return!group.includes(field)?accumulator.concat(renderCheckAnswersGroup(i,field,resource,array,group)):accumulator;},array);}ArrayAnswer.propTypes={arrayAnswer:_propTypes.default.shape({elements:_propTypes.default.shape()}).isRequired,resource:_propTypes.default.shape({alpha:_propTypes.default.string,omega:_propTypes.default.string}).isRequired,array:_propTypes.default.array,group:_propTypes.default.array};ArrayAnswer.defaultProps={arrayAnswer:{},resource:{},array:[],group:[]};var CheckAnswersGroup=function(_Group){_inherits(CheckAnswersGroup,_Group);var _super=_createSuper(CheckAnswersGroup);function CheckAnswersGroup(){var _this;_classCallCheck(this,CheckAnswersGroup);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_defineProperty(_assertThisInitialized(_this),"state",{});return _this;}_createClass(CheckAnswersGroup,[{key:"getClassName",value:function getClassName(){return(0,_classnames.default)(_get(_getPrototypeOf(CheckAnswersGroup.prototype),"getClassName",this).call(this),'check-answers');}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(props,state){var c=state.checkAnswers;var C=this.state.checkAnswers;return c!==C;}},{key:"renderAnswers",value:function renderAnswers(){var checkAnswers=this.props.checkAnswers;var _checkAnswers$meta=checkAnswers.meta;_checkAnswers$meta=_checkAnswers$meta===void 0?{}:_checkAnswers$meta;var type=_checkAnswers$meta.type;switch(type){case'string':{var resource=this.props.resource;return _react.default.createElement(_typeStringAnswer.default,{stringAnswer:checkAnswers,resource:resource});}case'number':{var _resource=this.props.resource;return _react.default.createElement(_typeNumberAnswer.default,{numberAnswer:checkAnswers,resource:_resource});}case'object':{var _this$props=this.props,_resource2=_this$props.resource,array=_this$props.array,group=_this$props.group;return _react.default.createElement(ObjectAnswer,{objectAnswer:checkAnswers,resource:_resource2,array:array,group:group});}case'array':{var _this$props2=this.props,_resource3=_this$props2.resource,_array=_this$props2.array,_group=_this$props2.group;return _react.default.createElement(ArrayAnswer,{arrayAnswer:checkAnswers,resource:_resource3,array:_array,group:_group});}case'boolean':{var _resource4=this.props.resource;return _react.default.createElement(_typeBooleanAnswer.default,{booleanAnswer:checkAnswers,resource:_resource4});}case'null':{var _resource5=this.props.resource;return _react.default.createElement(_typeNullAnswer.default,{nullAnswer:checkAnswers,resource:_resource5});}}return null;}},{key:"render",value:function render(){return _react.default.createElement("div",{className:this.getClassName()},this.renderAnswers());}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(_ref3,_ref4){var checkAnswers=_ref3.checkAnswers;var C=_ref4.checkAnswers;var c=_immutable.default.Map(checkAnswers);return{checkAnswers:_immutable.default.is(C,c)?C:c};}}]);return CheckAnswersGroup;}(_.default);exports.default=CheckAnswersGroup;CheckAnswersGroup.propTypes=_objectSpread(_objectSpread({},_.default.propTypes),{},{checkAnswers:_propTypes.default.shape(),resource:_propTypes.default.shape({alpha:_propTypes.default.string,omega:_propTypes.default.string})});CheckAnswersGroup.defaultProps=_objectSpread(_objectSpread({},_.default.defaultProps),{},{checkAnswers:{},resource:{}});